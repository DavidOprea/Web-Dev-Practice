<!DOCTYPE html>
<html lang = "en">
    <head>
        <meta charset="UTF-8"/>
        <title>Cascade Ciphers</title>

        <!--CSS Stuff-->
        <style>
            body {
                background-color: #1a202c;
                height: 100vh;
            }

            .head {
                display: flex;
                justify-content: space-between;
                align-items: center; /* This vertically centers the items */
            }

            #help-button {
                background-image: url("help.png");
                background-repeat: no-repeat;
                background-position: top;
                background-size: contain;
                background-color: #1a202c;
                border: None;
                padding: 1rem 1rem;
            }

            .hidden-text {
                color: #1a202c;
                user-select: none;
            }

            #title {
                font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
                text-align: center;
                color: white;
                stroke: black;
                stroke-width: 2px;
            }

            .modal-hidden {
                font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
                display: none; 
                position: fixed;
                z-index: 1; 
                left: 0;
                top: 0;
                width: 100%; 
                height: 100%; 
                overflow: auto; 
                background-color: rgba(0,0,0,0.4);
                color: aliceblue;
            }

            .modal-help {
                background-color: #262424;
                opacity: 0.8;
                margin: 15% auto; 
                padding: 20px;
                border: 1px solid #000000;
                width: 80%; 
            }

            #close-help {
                background-color: red;
                color: white;
                font-size: 2vw;
            }

            #points-label {
                font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
                display: flex;
                justify-content: center;
                color: white;
            }

            #word {
                display: flex;
                justify-content: center;
                color: white;
            }

            .button-container {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 1.5rem; 
                padding: 2rem;
                border-radius: 0.75rem;
            }

            #enter-button {
                font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
                color: white;
                background-color: green;
                border-radius: 0.25rem;
                stroke-width: 2px;
                font-size: large;
                width: 80px;
                height: 40px;
            }

            #enter-button:hover {
                background-color: rgb(1, 175, 1);
                transform: scale(1.10);
            }

            .grid-container {
                display: grid;
                grid-template-columns: repeat(6, 1fr);
                grid-template-rows: repeat(6, 1fr);
                justify-content: center;
                align-items: center;
                gap: 0.4vh;
                margin: 0 auto;
                width: 40vh;
            }

            .grid-container button {
                aspect-ratio: 1 / 1;
                background-color: rgb(199, 40, 40);
                display: flex;
                justify-content: center;
                align-items: center;
                font-size: 3rem;
                color: whitesmoke;
                font-weight: bold;
                text-transform: uppercase;
                border-radius: 0.25rem;
            }

            .grid-container button:hover {
                background-color: lightgray;
                transform: scale(1.1);
            }

            .grid-container button.toggled {
                background-color: #525252;
            }
        </style>
    </head>

    <body>
        <header class = "head">
            <h1 class="hidden-text">.....</h1>
            <h1 id="title">Cascade Ciphers</h1>
            <button id="help-button"></button>

            <!--This will be the window that appears when you click the "Help" button-->
            <div id="helpModal" class="modal-hidden">
                <div class="modal-help">
                    <h2>How to play Cascade Ciphers</h2>
                    <p>1. Find a word in our word list among the grid of letters. All letters must be adjecent to each other.</p>
                    <p>2. The word will color adjacent letters, giving you x2 points for those letters (and it stacks).</p>
                    <p>3. Try to get the most points at the end and get on the leaderboard!</p>
                    <button input="button", id="close-help">X</button>
                </div>
            </div>
        </header>
        
        <h2 id="points-label">Points: 0</h2>
            
        <!---The letters grid for my game-->
        <div class="grid-container" id="grid-container"></div>

        <div class = "button-container">
            <h1 class="hidden-text">.</h1>
            <h2 id="word"></h2>
            <button id="enter-button"><b>Enter</b></button>
            <h1 class="hidden-text">.</h1>
        </div>

        <!--JavaScript Stuff-->
        <script>
            const helpModal = document.getElementById('helpModal');
            const helpButton = document.getElementById('help-button');
            const enterButton = document.getElementById('enter-button');
            const closeHelpButton = document.getElementById('close-help');
            const word = document.getElementById('word');

            let wordDict = {};

            helpButton.addEventListener('click', () => {
                helpModal.classList.remove('hidden');
                helpModal.style.display = 'block'; // Or 'flex' for centering
            });

            closeHelpButton.addEventListener('click', () => {
                helpModal.classList.add('hidden');
                helpModal.style.display = 'none';
            });

            enterButton.addEventListener('click', () => {
                if(word.textContent.length >= 4 && wordDict.hasOwnProperty(word.textContent)){
                    points += 100 * word.textContent.length;
                    pointsLabel.textContent = "Points: " + points.toString();
                }
            })

            // Close modal when clicking outside of it
            window.addEventListener('click', (event) => {
                if (event.target === helpModal) {
                    helpModal.classList.add('hidden');
                    helpModal.style.display = 'none';
                }
            });

            document.addEventListener('DOMContentLoaded', () => {
                const gridContainer = document.getElementById('grid-container');
                const pointsLabel = document.getElementById("points-label");
                let points = 0;
                const numRows = 6;
                const numCols = 6; 

                for (let i = 0; i < numRows; i++) {
                    for (let j = 0; j < numCols; j++) {
                        const button = document.createElement('button');
                        button.className = 'grid-button';
                        button.textContent = String.fromCharCode(65 + Math.floor(Math.random() * 26));
                        button.addEventListener('click', () => {
                            if (!button.classList.contains('toggled')){
                                word.textContent = word.textContent + button.textContent;
                            }else{
                                let s = word.textContent;
                                let i = s.lastIndexOf(button.textContent);
                                word.textContent = s.slice(0, i) + s.slice(i+1);
                            }
                            button.classList.toggle('toggled');
                            //pointsLabel.textContent = "Points: " + points.toString();
                        });
                        gridContainer.appendChild(button);
                    }
                }
            });
        </script>
    </body>
</html>